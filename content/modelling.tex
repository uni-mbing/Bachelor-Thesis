\section{Modeling}

\subsection{Mathematical Formulation}

The model proposed by Anderson et al.~\cite{anderson_continuous_1998,anderson_mathematical_2000} and Chaplain et al.~\cite{anderson_continuous_1998,chaplain_mathematical_2006-1,franssen_mathematical_2019}, extended with terms for modeling cell proliferation and extracellular matrix renewal consists of a system of coupled partial differential equations: 
\begin{align}
	\frac{\partial c}{\partial t} &= D_c \Delta c - \chi \nabla \cdot (c\nabla e)  + \mu_1 c\left(1-\frac{c}{c_0}-\frac{e}{e_0}\right)\label{eq1}\\
	\frac{\partial e}{\partial t} &= -\delta m e  + \mu_2 c\left(1-\frac{c}{c_0}-\frac{e}{e_0}\right)\label{eq2}\\
	\frac{\partial m}{\partial t} &= D_m \Delta c + \mu_3 c - \lambda m\label{eq3}
\end{align}
with zero-flux boundary conditions:
\begin{align}
	\zeta \cdot  (-D_c \nabla c + c \chi\nabla e) &= 0 \label{eq4}\\
	\zeta \cdot (-D_m\nabla m ) &= 0\label{eq5}
\end{align}
where the free parameters are $D_c$, $D_m$, $\chi$, $\delta$, $\mu_1$, $\mu_2$, $\mu_3$, $\lambda$ and $\zeta$ is an appropriate outward unit vector. These free parameters as well as their non-dimensionalized versions are all assumed to be positive real numbers.

The variable $c$ describes the tumor cell density, $e$ the concentration of the extracellular matrix and $m$ the matrix-degrading enzyme concentration. All of those functions are mathematically defined to be mapping a one-, two- or three-dimensional spacial value $x$ and a temporal value $t$ to a scalar value describing the respective quantity at a specific point in space and time $(x,t)$:
\begin{align*}
     \{c,e,m\}: \mathbb{R}^{i} \times \mathbb{R} \rightarrow \mathbb{R}, i \in \{1,2,3\}
\end{align*}

To derive the expression of the tumor cell density $c$, we are going to assume that the tumor cell's motility is subject to two influences: haptotaxis and random movement. Haptotaxis is a directed migratory response of cells to gradients of fixed or bound chemicals~\cite{anderson_continuous_1998} and random movement is influenced by, for example, mechanical stress, electric charge or other physical effects~\cite{Merino-Casallo2022-di}. Haptotaxis is responsible for pulling the cancerous cells away from the primary tumor site into the surrounding tissue, towards the extracellular matrix molecules. This enables the tumor invasion process. We must define flux to get an expression of how much or how fast the tumor cells move. Flux is defined to be the amount of a substance that crosses a unit area in a unit time. Incorporating the two assumed influencing factors into our mathematical model; we define the haptotatic flux $J_{hapto}$ and random flux $J_{random}$:
\begin{align*}
    J_{hapto} = \chi c \nabla e \\
    J_{random} = -D_c \nabla c
\end{align*}
$\chi$ is the haptotactic flux coefficient and $D_c$ is a random mobility coefficient. These parameters could also be a function of, for example, extracellular matrix and or matrix-degrading enzyme concentration. Knowing that cells grow over time and proliferate, we want to respect this in our model with a term for tumor cell 
proliferation: 
\begin{align*}
    \mu_1 c (1-\frac{c}{c_0} - \frac{e}{e_0})
\end{align*}
The idea is that this term describes the cell proliferation with a logistic growth model respecting spacial limiting factors of already present extracellular matrix molecules and tumor cells, $\mu_1$ describes the rate at which tumor cell proliferation and growth happens. In the initial model proposed by Anderson et al.~\cite{anderson_continuous_1998, anderson_mathematical_2000} and Chaplain et al.~\cite{anderson_continuous_1998,chaplain_mathematical_2006-1,franssen_mathematical_2019}, they did not respect proliferation of tumor cells and extracellular matrix renewal. They applied a conservation equation for the tumor cells, which yields:
\begin{align*}
    \frac{\partial c}{\partial t} = -\nabla \cdot (J_{hapto} + J_{random}) \\
    \frac{\partial c}{\partial t} = -\nabla \cdot (\chi c \nabla e -D_c \nabla c ) \\
    \frac{\partial c}{\partial t} = D_c \Delta c - \chi \nabla \cdot (c\nabla e)
\end{align*}
The extended model incorporates proliferation and renewal into this conservation formula, resulting in equation~\ref{eq1}:
\begin{align*}
    \frac{\partial c}{\partial t} = -\nabla \cdot (J_{hapto} + J_{random}) + \mu_1 c (1-\frac{c}{c_0} - \frac{e}{e_0}) \\
    \frac{\partial c}{\partial t} = D_c \Delta c - \chi \nabla \cdot (c\nabla e) + \mu_1 c (1-\frac{c}{c_0} - \frac{e}{e_0})
\end{align*}
To model the extracellular-matrix concentration $e$, we assume that the enzymes degrade the extracellular matrix upon contact in an exponential way. The equation models this assumption:
\begin{align*}
    \frac{\partial e}{\partial t} = -\delta m e
\end{align*}
where $\delta$ is the constant describing this degradation process. For the extended model we add a term describing the renewal process of the extracellular matrix, which is also being modeled by logisitc growth incorporating limiting factors of present tumor cells and extracellular matrix molecules:
\begin{align*}
    \frac{\partial e}{\partial t} = -\delta m e + \mu_2 c (1 - \frac{c}{c_0} - \frac{e}{e_0})
\end{align*}
with $\mu_2$ being the coefficient describing the rate of the renewal process.

Modeling the matrix-degrading enzyme concentration $m$, we combine a diffusion term with production and decay terms. The diffusion term is described like for the tumor cells:
\begin{align*}
    J_{random} = -D_m \nabla c
\end{align*}
The production term depends on the tumor cell density $c$ and the decay term on the extracellular matrix concentration $m$. In both cases production and decay we are assuming exponential growth. Incorporating this gives us equation~\ref{eq3}:
\begin{align*}
    \frac{\partial m}{\partial t} = \nabla \cdot J_{random} + \mu c - \lambda e \\
    \frac{\partial m}{\partial t} = D_m \Delta c + \mu_3 c - \lambda m
\end{align*}
$\mu_3$ and $\delta$ describing production and decay coefficients.


\subsection{Numerical Formulation and Parameters}

To make solving the model easier, we will first non-dimensionalize all the equations~\ref{eq1} to~\ref{eq5} in a standard way to rescale the space domain to a unit size domain $\Omega$. For one space dimension this results in the unit interval $[0,1]$, for two the unit square $[0,1] \times [0,1]$ and for three spacial dimensions the unit cube $[0,1] \times [0,1] \times [0,1]$.

We start with non-dimensionalizing the three continuous variables $c,e,m$:
\begin{align*}
    \tilde{c} = \frac{c}{c_0} \\
    \tilde{e} = \frac{e}{e_0} \\
    \tilde{m} = \frac{m}{m_0}  
\end{align*}
Next we rescale distance with an appropriate length scale $L$ and time with $\tau = \frac{L^2}{D}$~\cite{anderson_mathematical_2000}, which will be described more detailed in section~\ref{sec:experiments}.

Modifying the system's free parameters $D_c, \chi, \delta, D_m, \mu_3, \lambda$ gives us: 
\begin{center}
    $d_c = \frac{D_c}{D},\quad \gamma = \chi \frac{e_0}{D},\quad \eta = \tau m_0 \delta,\quad d_m = \frac{D_m}{D},\quad \alpha = \tau \mu_3 \frac{c_0}{m_0},\quad \beta = \tau \lambda$.
\end{center} 
with $D$ being a reference chemical diffusion coefficient.

These modifications make the new system of coupled partial differential equations, where henceforth the tildes are dropped and we assume $t$ as $\tau$ for simplicities' sake:
\begin{align}
	\frac{\partial c}{\partial t} &= d_c \Delta c - \gamma \nabla \cdot (c\nabla e)  + \mu_1 c\left(1-c-e\right)\label{eq:6}\\
	\frac{\partial e}{\partial t} &= -\eta m e  + \mu_2 e\left(1-c-e\right)\label{eq:7}\\
	\frac{\partial m}{\partial t} &= d_m \Delta c + \alpha c - \beta m\label{eq:8}
\end{align}
with also updated zero-flux boundary conditions:
\begin{align}
	\zeta \cdot (-d_c \nabla c + c \gamma \nabla e) &= 0\label{eq:9}\\
	\zeta \cdot (-d_m\nabla m ) &= 0\label{eq:10}
\end{align}
where the free parameters are as decribed above and $\zeta$ stays an appropriate outward unit normal vector.
 
In order to use the Finite Element Method, we will change to the variational formulation. If we assume each species to be in the Hilbert space $H^1(\Omega)$, the variational formulation can be derived by multiplying with a test function $\varphi_j, j\in \{c,e,m\}$, integrating over the domain $\Omega$ and using integration by parts and the Gauss theorem. Using the variational formulation will give us a broader solution space and reduce the solution's requirements regarding differentiability. With $\left(\cdot, \cdot\right)$ denoting the $L^2$-scalar product on $\Omega$ the following equation system results:
\begin{align}
    \left(\frac{\partial c}{\partial t}, \varphi_c\right) &=
        - d_c\left(\nabla c, \nabla \varphi_c\right) + \gamma \left(c\nabla e, \nabla \varphi_c\right) + \mu_1 \left(c \left(1-\frac{c}{c_0} - \frac{e}{e_0}\right), \varphi_c\right) \label{eq:11}\\
    \left(\frac{\partial e}{\partial t}, \varphi_e\right) &=  -\eta \left( me, \varphi_e\right) + \mu_2 \left(e\left(1-\frac{c}{c_0}-\frac{e}{e_0}\right),\varphi_e\right) \label{eq:12}\\
    \left(\frac{\partial m}{\partial t}, \varphi_m\right) &= -d_m \left(\nabla m,\nabla \varphi_m\right) + \alpha \left(c,\varphi_m\right) - \beta \left(m,\varphi_m\right) \label{eq:13}
\end{align}
